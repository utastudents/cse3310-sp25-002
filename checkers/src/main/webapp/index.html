<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Page</title>
</head>
<body>

   <!-- Container of the login page -->
    <div class ="wrapper">
        <form action="">
          <h1>CHECKERS WITH 3310-002</h1>  
          <div class="input-box">
            <input type="text" placeholder="Enter Username" id="username" />
          </div>
          <button onclick="joinGame()">Join Game</button>
        </form>
      </div>
    
    <!-- Styling-->
  <style>  
    
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Garamond, serif;
}

body{
  min-height: 100vh;
  background-size: cover;
  display: flex;
  justify-content: center;
  align-items: center;
  background: burlywood;
  background: url('CheckersImage-2.jpg');
}
.wrapper{

  background-color: rgba(255, 250, 240, 0.95);
  padding: 40px;
  border-radius: 15px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
  max-width: 400px;
  width: 90%;
  text-align: center;
}

.wrapper h1{
  font-size: 22px;
  color: rgb(67,0,134);
}

.input-box input {
  width: 250px;
  padding: 12px;
  margin-top: 15px;
  font-size: 16px;
  border: 1px solid #ccc;
  border-radius: 5px;
}

button {
  margin-top: 15px;
  padding: 10px 20px; 
  font-size: 14px;
  background-color: black;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

button:hover {
  background-color: #333; 
}
            
</style>

  <script>
    function joinGame() {
      const username = document.getElementById('username').value;
      const pattern = /^(?=.*\d)(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{8,}$/;
      
      if (!username) {
      alert('Please enter a username.');
    } else if (!pattern.test(username)) {
      alert('Username must be atleast 8 characters long, and contain atleast one digit and one special character.');
    } else {
      alert('Joining Game');
      }
    }
/*          const userData = 
            {
                type: "join",
                username: username
            }
            // Sending data through websocket
            if(connection === WebSocket.OPEN)
            {
                connection.send(JSON.stringify(userData));
            }
            else
            {
                errorDiv.innerText = "Connection to server not available.";
                errorDiv.style.display = "block";
            }  */

        </script>
        </body>
        </html>
  
    </div>
        -->
    <div id="join_game">

    join game
    </div>
    <div id="game_display">
        game display
        <div style="width: 336px; max-width:auto; margin: 10px auto;" class="hidden" id="game_display_container">
            <div style="text-align: center; font-size: 16px; margin-top: 10px; font-weight: bold; color: #333;">
                <p id="current-player">Current Player: Player 1</p>
            </div>
            <br/>
            <div class="game" style="display: inline-block; border: 4px solid #333; background: #333; margin: 0 auto; box-shadow: 0 4px 12px rgba(0,0,0,0.3); width: 328px; height: 328px; padding: 0; box-sizing: content-box;"></div>
            <div style="margin-top: 15px; text-align: center;">
                <button id="resign_buttom" class="button" style="background-color: #ff4f4f; color: white; padding: 8px 16px; font-size: 14px; border: none; cursor: pointer; margin: 5px; border-radius: 20px; font-weight: bold; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); transition: all 0.2s ease;">Resign</button>
                <button id="offer_draw_button" class="button" style="background-color: #ffcb45; color: #333; padding: 8px 16px; font-size: 14px; border: none; cursor: pointer; margin: 5px; border-radius: 20px; font-weight: bold; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); transition: all 0.2s ease;">Offer Draw</button>
            </div>
        </div>
    </div>
    <div id="summary">
    summary
    </div>
    <div id="stuff">
        <input type="button" value="Send Something" onclick="msg()">
        <label for="tbox">Received</label>
        <textarea id="tbox" name="tbox" rows="4" cols="50">
        </textarea>
    </div>

    <!-- Note from gamedisplay: Our entire component mostly uses javascript to handle the game display. The only thing we use html for is to create the divs that will be used to display the game. The rest of the functionality is handled by javascript. -->
    <!-- WARNING: Do not remove this javascript file!! This javascript code contains logic for the game display. Imports the CheckersBoard class which contains methods to create and add functionality to the checkers board. -->
    <script src="js/game_display_checkers.js"></script>

    </body>
</html>
<script>
    // each of the 'divs' in the html page should have attributes to allow them to be hidden.
    // the page manager should send a small json message, that tells which of these are hidden
    // and which are visible when there is a change
    // something like "{"display_new_account":t,"display_join_game":f,"display_game_display:f,"display_summary":f}"


    // a reminder.  we want to create one websocket connection, and use if, basically forever.
    // or until the user decides to go to another page.
    // this requires everything to load from this page.
    var connection = null;

    var serverUrl;
    serverUrl = "ws://" + window.location.hostname + ":" + (parseInt(location.port) + 100);
    connection = new WebSocket(serverUrl);

    connection.onopen = function (evt) {
        console.log("open");
    }

    connection.onclose = function (evt) {
        console.log("close");
    }

    connection.onmessage = function (evt) {
        var msg;
        msg = evt.data;


        console.log("Message received: " + msg);
        document.getElementById("tbox").innerHTML = msg + '\n' + document.getElementById("tbox").innerHTML;
        const obj = JSON.parse(msg);

        let data = JSON.parse(msg);

        // this function handles/receives all the data that is sent to the game dispaly through websockets. Please check `webapp\js\game_display_checkers.js` for more details
        // DO NOT REMOVE OR MODIFY THIS FUNCTION WIHTOUT OUR KNOWLEDGE. IT IS CRUCIAL FOR THE GAME DISPLAY TO WORK PROPERLY.
        game_display_handle_websocket_received_data(connection, data);

    }

    // Note from Game Display: comment the line below to hide the game board
    setTimeout(show_game_display(connection, "134242424", "this is player 1", "this is player2", "B"),3000);

    class UserEvent {
        msg;
    }

    function msg() {
        console.log("button clicked");
        U = new UserEvent();
        U.msg="i pushed a button";
        connection.send(JSON.stringify(U));
        console.log(JSON.stringify(U))
    }

</script>
